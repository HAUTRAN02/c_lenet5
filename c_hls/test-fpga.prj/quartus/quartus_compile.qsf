# This Quartus settings file sets up a project to measure the area and fmax of
# your components in a full Quartus compilation for the targeted device

# Family and device are derived from the -march argument to i++
set_global_assignment -name FAMILY "CycloneV"
set_global_assignment -name DEVICE 5CGXFC7C7F23C8
# This script parses the Quartus reports and generates a summary that can be viewed via reports/report.html or reports/lib/json/quartus.json
set_global_assignment -name POST_FLOW_SCRIPT_FILE "quartus_sh:generate_report.tcl"

# Files implementing a basic registered instance of each component
set_global_assignment -name TOP_LEVEL_ENTITY quartus_compile
set_global_assignment -name SDC_FILE quartus_compile.sdc
set_global_assignment -name QSYS_FILE ../components/avgpooling1/avgpooling1.qsys
set_global_assignment -name QSYS_FILE ../components/avgpooling2/avgpooling2.qsys
set_global_assignment -name QSYS_FILE ../components/conv1/conv1.qsys
set_global_assignment -name QSYS_FILE ../components/conv2/conv2.qsys
set_global_assignment -name QSYS_FILE ../components/fc1/fc1.qsys
set_global_assignment -name QSYS_FILE ../components/fc3/fc3.qsys
set_global_assignment -name QSYS_FILE ../components/relu1/relu1.qsys
set_global_assignment -name QSYS_FILE ../components/relu2/relu2.qsys
set_global_assignment -name QSYS_FILE ../components/relu3/relu3.qsys
set_global_assignment -name QSYS_FILE ../components/relu4/relu4.qsys
set_global_assignment -name QSYS_FILE ../components/softmax/softmax.qsys
set_global_assignment -name SYSTEMVERILOG_FILE quartus_compile.sv

# Partitions are used to separate the component logic from the project harness when tallying area results
set_global_assignment -name PARTITION_NETLIST_TYPE SOURCE -section_id component_partition
set_global_assignment -name PARTITION_FITTER_PRESERVATION_LEVEL PLACEMENT_AND_ROUTING -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_avgpooling1 -to "avgpooling1:avgpooling1_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_avgpooling2 -to "avgpooling2:avgpooling2_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_conv1 -to "conv1:conv1_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_conv2 -to "conv2:conv2_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_fc1 -to "fc1:fc1_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_fc3 -to "fc3:fc3_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_relu1 -to "relu1:relu1_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_relu2 -to "relu2:relu2_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_relu3 -to "relu3:relu3_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_relu4 -to "relu4:relu4_inst" -section_id component_partition
set_instance_assignment -name PARTITION_HIERARCHY component_softmax -to "softmax:softmax_inst" -section_id component_partition

# No need to generate a bitstream for this compile so save time by skipping the assembler
set_global_assignment -name FLOW_DISABLE_ASSEMBLER ON

# Use the --quartus-seed flag to i++, or modify this setting to run other seeds
# set_global_assignment -name SEED 0
# This assignment configures all component I/Os as virtual pins to more accurately
# model placement and routing in a larger system
set_instance_assignment -name VIRTUAL_PIN ON -to *